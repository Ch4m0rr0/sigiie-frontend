<aside 
  class="bg-slate-900 border-r border-slate-800 h-full flex flex-col shadow-2xl z-50 transition-[width] duration-300 ease-in-out overflow-hidden"
  [class.w-72]="!isCollapsed()"
  [class.w-20]="isCollapsed()"
>
  
  <div class="h-20 flex-shrink-0 flex items-center justify-between px-4 border-b border-slate-800 bg-slate-900">
    
    @if (!isCollapsed()) {
      <div class="flex items-center gap-3 overflow-hidden whitespace-nowrap animate-fade-in min-w-0">
        <div class="w-8 h-8 rounded-lg bg-white p-1 flex-shrink-0 flex items-center justify-center">
          <img 
            src="assets/Isotipo UNAN.jpg" 
            alt="Logo" 
            class="w-full h-full object-contain"
            width="200"
            height="200"
            loading="lazy"
          >
        </div>
        <div>
          <h2 class="text-lg font-bold text-white tracking-tight leading-none">SIGIIE</h2>
        </div>
      </div>
    }

    <button 
        (click)="toggleSidebar()"
        class="p-2 rounded-lg text-slate-400 hover:text-white hover:bg-slate-800 transition-colors flex items-center justify-center"
        [class.mx-auto]="isCollapsed()"
        [class.w-full]="isCollapsed()"
        [title]="isCollapsed() ? 'Expandir' : 'Colapsar'">
        <app-icon [icon]="isCollapsed() ? 'menu' : 'chevron_left'" size="sm"></app-icon>
    </button>
  </div>

  <nav class="flex-1 overflow-y-auto custom-scrollbar py-6 flex flex-col gap-6 overflow-x-hidden">
    
    <div class="px-3">
      @if (!isCollapsed()) {
        <h3 class="px-4 text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 animate-fade-in whitespace-nowrap">Principal</h3>
      } @else {
        <div class="w-8 h-[1px] bg-slate-800 mx-auto mb-4"></div>
      }

      <div class="space-y-1">
        <!-- Dashboard siempre visible para usuarios autenticados -->
        <a routerLink="/dashboard" 
           routerLinkActive="bg-blue-600 text-white shadow-lg shadow-blue-900/20"
           class="flex items-center gap-3 px-3 py-3 text-sm font-medium text-slate-400 rounded-lg hover:bg-slate-800 hover:text-white transition-all duration-200 group relative"
           [class.justify-center]="isCollapsed()" 
           [title]="isCollapsed() ? 'Dashboard' : ''">
           
           <app-icon icon="dashboard" size="sm" className="group-hover:text-white transition-colors flex-shrink-0"></app-icon>
           
           @if (!isCollapsed()) { 
             <span class="whitespace-nowrap animate-fade-in">Dashboard</span> 
           }
        </a>
      </div>
    </div>

    <div class="px-3">
        @if (!isCollapsed()) {
          <h3 class="px-4 text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 animate-fade-in whitespace-nowrap">Gesti칩n</h3>
        } @else {
          <div class="w-8 h-[1px] bg-slate-800 mx-auto mb-4"></div>
        }
        
        <div class="space-y-1">
          <!-- Proyectos oculto -->
          <!-- <a *hasPermission="'proyectos.ver'" 
             routerLink="/proyectos" 
             routerLinkActive="bg-blue-600 text-white shadow-lg shadow-blue-900/20"
             class="flex items-center gap-3 px-3 py-3 text-sm font-medium text-slate-400 rounded-lg hover:bg-slate-800 hover:text-white transition-all duration-200 group relative"
             [class.justify-center]="isCollapsed()"
             title="Proyectos">
             <app-icon icon="folder_open" size="sm" className="group-hover:text-white transition-colors flex-shrink-0"></app-icon>
             @if (!isCollapsed()) { <span class="whitespace-nowrap animate-fade-in">Proyectos</span> }
          </a> -->

          <a *hasPermission="'actividades.ver'" 
             routerLink="/actividades" 
             routerLinkActive="bg-blue-600 text-white shadow-lg shadow-blue-900/20"
             class="flex items-center gap-3 px-3 py-3 text-sm font-medium text-slate-400 rounded-lg hover:bg-slate-800 hover:text-white transition-all duration-200 group relative"
             [class.justify-center]="isCollapsed()"
             title="Actividades">
             <app-icon icon="assignment" size="sm" className="group-hover:text-white transition-colors flex-shrink-0"></app-icon>
             @if (!isCollapsed()) { <span class="whitespace-nowrap animate-fade-in">Actividades</span> }
          </a>

        <a *hasPermission="'subactividades.ver'" 
           routerLink="/subactividades" 
           routerLinkActive="bg-blue-600 text-white shadow-lg shadow-blue-900/20"
           class="flex items-center gap-3 px-3 py-3 text-sm font-medium text-slate-400 rounded-lg hover:bg-slate-800 hover:text-white transition-all duration-200 group relative"
           [class.justify-center]="isCollapsed()"
           title="Subactividades">
           <app-icon icon="subdirectory_arrow_right" size="sm" className="group-hover:text-white transition-colors flex-shrink-0"></app-icon>
           @if (!isCollapsed()) { <span class="whitespace-nowrap animate-fade-in">Subactividades</span> }
        </a>
        </div>
    </div>

    <div class="px-3">
        @if (!isCollapsed()) {
          <h3 class="px-4 text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 animate-fade-in whitespace-nowrap">Seguimiento</h3>
        } @else {
            <div class="w-8 h-[1px] bg-slate-800 mx-auto mb-4"></div>
        }
        <div class="space-y-1">
            <a *hasPermission="'participaciones.ver'" 
               routerLink="/participaciones" 
               routerLinkActive="bg-blue-600 text-white shadow-lg shadow-blue-900/20"
               class="flex items-center gap-3 px-3 py-3 text-sm font-medium text-slate-400 rounded-lg hover:bg-slate-800 hover:text-white transition-all duration-200 group relative"
               [class.justify-center]="isCollapsed()" title="Participaciones">
               <app-icon icon="groups" size="sm" className="group-hover:text-white transition-colors flex-shrink-0"></app-icon>
               @if (!isCollapsed()) { <span class="whitespace-nowrap animate-fade-in">Participaciones</span> }
            </a>
            
            <a *hasPermission="'evidencias.ver'" 
               routerLink="/evidencias" 
               routerLinkActive="bg-blue-600 text-white shadow-lg shadow-blue-900/20"
               class="flex items-center gap-3 px-3 py-3 text-sm font-medium text-slate-400 rounded-lg hover:bg-slate-800 hover:text-white transition-all duration-200 group relative"
               [class.justify-center]="isCollapsed()" title="Evidencias">
               <app-icon icon="perm_media" size="sm" className="group-hover:text-white transition-colors flex-shrink-0"></app-icon>
               @if (!isCollapsed()) { <span class="whitespace-nowrap animate-fade-in">Evidencias</span> }
            </a>

            <a *hasPermission="'reportes.ver'" 
               routerLink="/reportes" 
               routerLinkActive="bg-blue-600 text-white shadow-lg shadow-blue-900/20"
               class="flex items-center gap-3 px-3 py-3 text-sm font-medium text-slate-400 rounded-lg hover:bg-slate-800 hover:text-white transition-all duration-200 group relative"
               [class.justify-center]="isCollapsed()" title="Reportes">
               <app-icon icon="bar_chart" size="sm" className="group-hover:text-white transition-colors flex-shrink-0"></app-icon>
               @if (!isCollapsed()) { <span class="whitespace-nowrap animate-fade-in">Reportes</span> }
            </a>
        </div>
    </div>
    
     <div class="px-3">
        @if (!isCollapsed()) {
          <h3 class="px-4 text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 animate-fade-in whitespace-nowrap">Admin</h3>
        } @else {
            <div class="w-8 h-[1px] bg-slate-800 mx-auto mb-4"></div>
        }
        <div class="space-y-1">
            <a *hasPermission="'personas.ver'" 
               routerLink="/personas" 
               routerLinkActive="bg-blue-600 text-white shadow-lg shadow-blue-900/20"
               class="flex items-center gap-3 px-3 py-3 text-sm font-medium text-slate-400 rounded-lg hover:bg-slate-800 hover:text-white transition-all duration-200 group relative"
               [class.justify-center]="isCollapsed()" title="Personas">
               <app-icon icon="badge" size="sm" className="group-hover:text-white transition-colors flex-shrink-0"></app-icon>
               @if (!isCollapsed()) { <span class="whitespace-nowrap animate-fade-in">Personas</span> }
            </a>

            @if (puedeVerUsuarios()) {
              <a routerLink="/usuarios" 
                 routerLinkActive="bg-blue-600 text-white shadow-lg shadow-blue-900/20"
                 class="flex items-center gap-3 px-3 py-3 text-sm font-medium text-slate-400 rounded-lg hover:bg-slate-800 hover:text-white transition-all duration-200 group relative"
                 [class.justify-center]="isCollapsed()" title="Usuarios">
                 <app-icon icon="manage_accounts" size="sm" className="group-hover:text-white transition-colors flex-shrink-0"></app-icon>
                 @if (!isCollapsed()) { <span class="whitespace-nowrap animate-fade-in">Usuarios</span> }
              </a>
            }
            
            <a *hasPermission="'catalogos.ver'" 
               routerLink="/catalogos" 
               routerLinkActive="bg-blue-600 text-white shadow-lg shadow-blue-900/20"
               class="flex items-center gap-3 px-3 py-3 text-sm font-medium text-slate-400 rounded-lg hover:bg-slate-800 hover:text-white transition-all duration-200 group relative"
               [class.justify-center]="isCollapsed()" title="Cat치logos">
               <app-icon icon="folder" size="sm" className="group-hover:text-white transition-colors flex-shrink-0"></app-icon>
               @if (!isCollapsed()) { <span class="whitespace-nowrap animate-fade-in">Cat치logos</span> }
            </a>
        </div>
    </div>

  </nav>

  <div class="p-3 border-t border-slate-800 bg-slate-900 flex-shrink-0 z-10">
    <div class="flex items-center gap-3 p-2 rounded-xl hover:bg-slate-800 transition-colors group cursor-pointer overflow-hidden relative"
         [class.justify-center]="isCollapsed()">
        
        <div class="w-9 h-9 rounded-full bg-gradient-to-tr from-blue-500 to-indigo-600 flex items-center justify-center text-white font-bold text-xs shadow-md flex-shrink-0">
            {{ getIniciales() }}
        </div>
        
        @if (!isCollapsed()) {
            <div class="flex flex-col min-w-0 animate-fade-in">
                <span class="text-sm font-semibold text-white truncate group-hover:text-blue-400 transition-colors">
                  {{ getNombreCompleto() }}
                </span>
            </div>
            
            <button (click)="logout()" class="ml-auto p-1.5 text-slate-400 hover:text-red-400 hover:bg-red-400/10 rounded-lg transition-all" title="Cerrar Sesi칩n">
                <app-icon icon="logout" size="xs"></app-icon>
            </button>
        }
    </div>
  </div>

</aside>